
## Техническое задание: Сервис авторизации (Auth Service)

### 1. Общая информация

Название сервиса: Auth Service

Цель сервиса: Предоставление функций регистрации и аутентификации пользователей для микросервисной архитектуры сервиса рекомендаций фильмов.

Язык программирования: Python

Фреймворк: FastAPI

База данных: PostgreSQL

Система кэширования: Redis (опционально)

Система оркестрации: Kubernetes/Docker Swarm

### 2. Функциональные требования

2.1. Регистрация пользователей:

• Поддержка регистрации новых пользователей с помощью email и пароля.
• Валидация email (уникальность, формат).
• Хеширование паролей с использованием bcrypt или аналогичного алгоритма.
• Возможность подтверждения email (опционально).

2.2. Аутентификация пользователей:

• Поддержка аутентификации пользователей по email и паролю.
• Генерация JWT-токенов для авторизации пользователей.
• Выдача токена доступа и токена обновления.
• Проверка валидности токена (подпись, срок действия, идентификатор пользователя).
• Логирование попыток аутентификации (успешные/неудачные).

2.3. Управление пользователями:

• Возможность изменения пароля.
• Возможность обновления профиля пользователя (имя, фамилия).
• Возможность удаления аккаунта пользователя.

2.4. API:

• Регистрация:
* POST /register - регистрация нового пользователя.
  • Аутентификация:
* POST /login - аутентификация существующего пользователя.
* POST /refresh - получение нового токена доступа с использованием токена обновления.
  • Управление пользователями:
* PUT /users/{user_id}/password - изменение пароля.
* PUT /users/{user_id}/profile - обновление профиля пользователя.
* DELETE /users/{user_id} - удаление аккаунта пользователя.

### 3. Нефункциональные требования

3.1. Безопасность:

• Хеширование паролей с использованием стойкого алгоритма (bcrypt, scrypt).
• Защита от атак на основе грубой силы.
• Шифрование секретного ключа JWT.
• Защита от атак типа XSS, SQL-инъекций.

3.2. Производительность:

• Минимальное время отклика на запросы.
• Масштабируемость сервиса для обработки больших объемов запросов.

3.3. Доступность:

• Обеспечение высокой доступности сервиса.
• Реализация механизмов отказоустойчивости (резервные копии, репликация).

### 4. Технические детали

• Фреймворк: FastAPI
• База данных: PostgreSQL
• ORM: SQLAlchemy
• JWT библиотека: PyJWT
• Хеширование паролей: bcrypt
• Кэш: Redis (опционально)
• Система оркестрации: Kubernetes/Docker Swarm
• Инструменты тестирования: pytest/unittest

### 5. Дополнительные возможности (optional)

• Поддержка двухфакторной аутентификации (2FA).
• Интеграция с системами социальной аутентификации (Google, Facebook).
• Возможность восстановления пароля.
• Поддержка роли пользователя.
• Локализация сообщений.


Важно: Данное техническое задание является примерным и может быть модифицировано в зависимости от конкретных потребностей проекта.
